# ci.yml file
...
- name: Run Cypress ðŸŒ²
  uses: cypress-io/github-action@v2
  env:
    CYPRESS_BASE_URL: ${{ github.event.deployment_status.target_url }}

# https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#job-status-check-functions
- name: Cypress tests âœ…
  if: ${{ success() }}
  # set the merge commit status check
  # using GitHub REST API
  # see https://docs.github.com/en/rest/reference/repos#create-a-commit-status
  run: |
    curl --request POST \
    --url https://api.github.com/repos/${{ github.repository }}/statuses/${{ github.sha }} \
    --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
    --header 'content-type: application/json' \
    --data '{
      "context": "e2e",
      "state": "success",
      "description": "Cypress tests passed"
    }'

- name: Cypress tests ðŸš¨
  if: ${{ failure() }}
  run: |
    curl --request POST \
    --url https://api.github.com/repos/${{ github.repository }}/statuses/${{ github.sha }} \
    --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
    --header 'content-type: application/json' \
    --data '{
      "context": "e2e",
      "state": "failure",
      "description": "Cypress tests failed"
    }'
